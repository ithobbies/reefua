"use strict";exports.id=353,exports.ids=[353],exports.modules={15079:(e,a,s)=>{s.d(a,{bq:()=>u,eb:()=>f,gC:()=>x,l6:()=>c,yv:()=>m});var r=s(60687),t=s(43210),l=s(22670),i=s(61662),d=s(89743),n=s(58450),o=s(4780);let c=l.bL;l.YJ;let m=l.WT,u=t.forwardRef(({className:e,children:a,...s},t)=>(0,r.jsxs)(l.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[a,(0,r.jsx)(l.In,{asChild:!0,children:(0,r.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=l.l9.displayName;let p=t.forwardRef(({className:e,...a},s)=>(0,r.jsx)(l.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,r.jsx)(d.A,{className:"h-4 w-4"})}));p.displayName=l.PP.displayName;let h=t.forwardRef(({className:e,...a},s)=>(0,r.jsx)(l.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})}));h.displayName=l.wn.displayName;let x=t.forwardRef(({className:e,children:a,position:s="popper",...t},i)=>(0,r.jsx)(l.ZL,{children:(0,r.jsxs)(l.UC,{ref:i,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...t,children:[(0,r.jsx)(p,{}),(0,r.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(h,{})]})}));x.displayName=l.UC.displayName,t.forwardRef(({className:e,...a},s)=>(0,r.jsx)(l.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=l.JU.displayName;let f=t.forwardRef(({className:e,children:a,...s},t)=>(0,r.jsxs)(l.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.VF,{children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})}),(0,r.jsx)(l.p4,{children:a})]}));f.displayName=l.q7.displayName,t.forwardRef(({className:e,...a},s)=>(0,r.jsx)(l.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...a})).displayName=l.wv.displayName},16189:(e,a,s)=>{var r=s(65773);s.o(r,"notFound")&&s.d(a,{notFound:function(){return r.notFound}}),s.o(r,"useParams")&&s.d(a,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(a,{useRouter:function(){return r.useRouter}})},34729:(e,a,s)=>{s.d(a,{T:()=>i});var r=s(60687),t=s(43210),l=s(4780);let i=t.forwardRef(({className:e,...a},s)=>(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...a}));i.displayName="Textarea"},37353:(e,a,s)=>{s.d(a,{c:()=>B});var r=s(60687),t=s(43210),l=s(16189),i=s(29523),d=s(44493),n=s(89667),o=s(80013),c=s(34729),m=s(15079),u=s(29867),p=s(82614);let h=(0,p.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),x=(0,p.A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var f=s(11516),g=s(85814),j=s.n(g),b=s(49315),y=s(33784),v=s(24890),N=s(75535),w=s(70146),R=s(55511);let P={randomUUID:R.randomUUID},U=new Uint8Array(256),C=U.length,F=[];for(let e=0;e<256;++e)F.push((e+256).toString(16).slice(1));let L=function(e,a,s){if(P.randomUUID&&!a&&!e)return P.randomUUID();let r=(e=e||{}).random??e.rng?.()??(C>U.length-16&&((0,R.randomFillSync)(U),C=0),U.slice(C,C+=16));if(r.length<16)throw Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,a){if((s=s||0)<0||s+16>a.length)throw RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let e=0;e<16;++e)a[s+e]=r[e];return a}return function(e,a=0){return(F[e[a+0]]+F[e[a+1]]+F[e[a+2]]+F[e[a+3]]+"-"+F[e[a+4]]+F[e[a+5]]+"-"+F[e[a+6]]+F[e[a+7]]+"-"+F[e[a+8]]+F[e[a+9]]+"-"+F[e[a+10]]+F[e[a+11]]+F[e[a+12]]+F[e[a+13]]+F[e[a+14]]+F[e[a+15]]).toLowerCase()}(r)};function B({existingLot:e}){let{toast:a}=(0,u.dj)(),s=(0,l.useRouter)(),{user:p,loading:g}=(0,b.A)(),R=!!e,[P,U]=(0,t.useState)({}),[C,F]=(0,t.useState)([]),[B,T]=(0,t.useState)(null),[A,$]=(0,t.useState)(null),[q,S]=(0,t.useState)(!1),[k,Z]=(0,t.useState)(0),[D,I]=(0,t.useState)(!1),W=e=>{let{name:a,value:s,type:r}=e.target,t="number"===r&&""!==s?parseFloat(s):s;if(a.includes(".")){let[e,s]=a.split(".");U(a=>({...a,[e]:{...a[e],[s]:t}}))}else U(e=>({...e,[a]:t}))},z=async()=>{if(!B){if(R&&A)return A;throw Error("Файл зображення не вибрано.")}if(!p)throw Error("Користувач не автентифікований.");S(!0),Z(0);let e=(0,w.c7)(y.yA);e.maxUploadRetryTime=6e4;let a=B.name.split(".").pop(),s=`${L()}.${a}`,r=(0,w.KR)(e,`lot-images/${s}`);return new Promise((e,a)=>{let s=(0,w.bp)(r,B);s.on("state_changed",e=>Z(e.bytesTransferred/e.totalBytes*100),e=>{console.error("Upload failed:",e),S(!1),a(e)},()=>{(0,w.qk)(s.snapshot.ref).then(e).catch(a),S(!1)})})},E=async r=>{if(r.preventDefault(),!P.name||!P.description||!P.category||!P.startingBid||!P.endTime)return void a({variant:"destructive",title:"Помилка валідації",description:"Будь ласка, заповніть усі обов'язкові поля."});if(!B&&!R)return void a({variant:"destructive",title:"Помилка валідації",description:"Будь ласка, завантажте зображення."});I(!0);try{let r=await z(),t={name:P.name,description:P.description,category:P.category,startingBid:P.startingBid,endTime:new Date(P.endTime).toISOString(),images:[r],parameters:P.parameters};if(P.buyNowPrice&&(t.buyNowPrice=P.buyNowPrice),R&&e){let r=(0,N.H9)(y.db,"lots",e.id);await (0,N.mZ)(r,t),a({title:"Лот оновлено!",description:`Лот "${P.name}" успішно оновлено.`}),s.push("/dashboard/lots")}else{let e=(0,v.Qg)(y.Cn,"createLot"),r=await e(t);a({title:"Лот створено!",description:`Лот "${P.name}" успішно додано.`}),s.push(`/lot/${r.data.id}`)}}catch(e){console.error(`Failed to ${R?"update":"create"} lot:`,e),a({variant:"destructive",title:`Помилка ${R?"оновлення":"створення"} лоту`,description:"Будь ласка, перевірте дані та спробуйте ще раз."})}finally{I(!1)}};if(g||!p)return(0,r.jsx)("div",{className:"text-center py-20",children:"Завантаження..."});let M=q||D;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(i.$,{variant:"outline",size:"icon",asChild:!0,children:(0,r.jsx)(j(),{href:"/dashboard/lots",children:(0,r.jsx)(h,{className:"h-4 w-4"})})}),(0,r.jsx)("h1",{className:"text-2xl font.headline font-semibold text-primary",children:R?"Редагувати Лот":"Створити Новий Лот"})]}),(0,r.jsx)("form",{onSubmit:E,children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Основна інформація"}),(0,r.jsx)(d.BT,{children:"Надайте деталі про ваш лот."})]}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"name",children:"Назва лоту*"}),(0,r.jsx)(n.p,{id:"name",name:"name",placeholder:"Фраг Acropora Red Planet",value:P.name||"",onChange:W,required:!0,disabled:M})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"description",children:"Опис лоту*"}),(0,r.jsx)(c.T,{id:"description",name:"description",placeholder:"Детальний опис вашого коралу, його особливості, розмір тощо.",value:P.description||"",onChange:W,required:!0,disabled:M})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"category",children:"Категорія*"}),(0,r.jsxs)(m.l6,{name:"category",value:P.category||"",onValueChange:e=>{U(a=>({...a,category:e}))},required:!0,disabled:M||0===C.length,children:[(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:C.length>0?"Оберіть категорію":"Завантаження..."})}),(0,r.jsx)(m.gC,{children:C.map(e=>(0,r.jsx)(m.eb,{value:e,children:e},e))})]})]})]})]}),(0,r.jsxs)(d.Zp,{children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{children:"Ціноутворення та аукціон"})}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"startingBid",children:"Стартова ціна (грн)*"}),(0,r.jsx)(n.p,{id:"startingBid",name:"startingBid",type:"number",placeholder:"100",value:P.startingBid||"",onChange:W,required:!0,disabled:M})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"buyNowPrice",children:'Ціна "Купити зараз" (грн, необов\'язково)'}),(0,r.jsx)(n.p,{id:"buyNowPrice",name:"buyNowPrice",type:"number",placeholder:"500",value:P.buyNowPrice||"",onChange:W,disabled:M})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"endTime",children:"Час завершення аукціону*"}),(0,r.jsx)(n.p,{id:"endTime",name:"endTime",type:"datetime-local",value:P.endTime||"",onChange:W,required:!0,disabled:M})]})]})]}),(0,r.jsxs)(d.Zp,{children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{children:"Параметри утримання"})}),(0,r.jsxs)(d.Wu,{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"salinity",children:"Солоність"}),(0,r.jsx)(n.p,{id:"salinity",name:"parameters.salinity",placeholder:"1.025 SG",value:P.parameters?.salinity||"",onChange:W,disabled:M})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"par",children:"PAR"}),(0,r.jsx)(n.p,{id:"par",name:"parameters.par",placeholder:"250-350",value:P.parameters?.par||"",onChange:W,disabled:M})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Label,{htmlFor:"flow",children:"Течія"}),(0,r.jsx)(n.p,{id:"flow",name:"parameters.flow",placeholder:"Помірна",value:P.parameters?.flow||"",onChange:W,disabled:M})]})]})]})]}),(0,r.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Зображення лоту*"}),(0,r.jsx)(d.BT,{children:"Завантажте основне фото вашого лоту."})]}),(0,r.jsxs)(d.Wu,{children:[(0,r.jsx)(o.Label,{htmlFor:"image",className:`block w-full cursor-pointer ${M?"cursor-not-allowed":""}`,children:(0,r.jsx)("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-muted rounded-md hover:border-primary transition-colors",children:A?(0,r.jsx)("img",{src:A,alt:"Попередній перегляд",className:"max-h-48 rounded-md object-contain"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x,{className:"h-12 w-12 text-muted-foreground"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Натисніть, щоб завантажити"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"(PNG, JPG, WEBP до 5MB)"})]})})}),(0,r.jsx)(n.p,{id:"image",name:"image",type:"file",onChange:e=>{if(e.target.files&&e.target.files[0]){let a=e.target.files[0];T(a),$(URL.createObjectURL(a))}},accept:"image/*",className:"sr-only",disabled:M,required:!R}),q&&(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:(0,r.jsx)("div",{className:"bg-primary h-2.5 rounded-full",style:{width:`${k}%`}})}),(0,r.jsx)("p",{className:"mt-2 text-xs text-muted-foreground text-center",children:"Для додавання більше фотографій, відредагуйте лот після створення."})]})]}),(0,r.jsxs)(i.$,{type:"submit",className:"w-full text-lg py-3",disabled:M,children:[M&&(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}),M?"Обробка...":R?"Зберегти зміни":"Створити лот"]})]})]})})]})}}};